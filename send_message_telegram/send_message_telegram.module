<?php

use Drupal\Core\Form\FormStateInterface;


function send_message_telegram_form_alter(&$form, FormStateInterface $form_state, $form_id)
{
    if ($form_id === 'node_send_message_telegram_form') {
        $form['actions']['submit']['#submit'][] = 'send_message_telegram_submit';
    }
    // dsm($form_id);
}

function send_message_telegram_submit($form, FormStateInterface $form_state)
{

      $botToken = "763965648:AAEhSIPxA5spaTHV8WsG4GCqih-62SFnwzE";
      $chat_id = "@sharif_job";
      $bot_url = "https://api.telegram.org/bot$botToken/";

      //get variable
      $title = $form_state->getValue('title')[0][value];//0
      $body = $form_state->getValue('body')[0][value];//1
      $field_education = $form_state->getValue('field_education')[0][value];//2
      $field_numbers_sharif = $form_state->getValue('field_numbers_sharif')[0][value];//3
      $field_experience = $form_state->getValue('field_experience')[0][value];//4
      $field_meet = $form_state->getValue('field_meet')[0][value];//5
      $field_max_year = $form_state->getValue('field_max_year')[0][value];//6
      $field_advantages = $form_state->getValue('field_advantages')[0][value];//7
      $field_call = $form_state->getValue('field_call')[0][value];//8
      $field_email_address = $form_state->getValue('field_email_address')[0][value];//9
      $field_address_telegram = $form_state->getValue('field_address_telegram')[0][value];//10


      $message = array($title,$body,$field_education,$field_numbers_sharif,$field_experience,  $field_meet,$field_max_year,$field_advantages,$field_call,$field_email_address,$field_address_telegram);
      $message_body = $message[1];


    $string = strip_tags($message_body);
    $string_body = str_replace( array( '&nbsp;' ), 'Ø´Ø±ÛŒÙ Ú©Ù„Ø§Ø¨ ', $string);
    $url = $bot_url."sendMessage?chat_id=".$chat_id."&text=".urlencode(
    "Ø¹Ù†ÙˆØ§Ù† Ø¢Ú¯Ù‡ÛŒ: ".$message[0]."\r\n".
    "Ù…Ø¹Ø±ÙÛŒ Ø´Ø±Ú©Øª: ".$string_body."\r\n\r\n".
    "ðŸ”»Ø´Ø±Ø§ÛŒØ· Ø§Ø­Ø±Ø§Ø²"."\r\n\r\n".
    "ðŸ”¹ØªØ­ØµÛŒÙ„Ø§Øª: ".$message[2]."\r\n".
    "ðŸ”¹ØªØ¬Ø±Ø¨Ù‡: ".$message[4]."\r\n".
    "ðŸ”¹Ø§ÙØ±Ø§Ø¯ Ø´Ø±ÛŒÙÛŒ: ".$message[3]."\r\n".
    "ðŸ”¹Ø¢Ø´Ù†Ø§ÛŒÛŒ Ø¨Ø§: ".$message[5]."\r\n".
    "ðŸ”¹Ø­Ø¯Ø§Ú©Ø«Ø± Ø³Ù†: ".$message[6]."\r\n".
    "ðŸ”»Ù…Ø²Ø§ÛŒØ§: ".$message[7]."\r\n\r\n".

    "Ø§Ø² Ù…ØªÙ‚Ø§Ø¶ÛŒØ§Ù† Ø¹Ø²ÛŒØ² Ø®ÙˆØ§Ù‡Ø´Ù…Ù†Ø¯ Ø§Ø³Øª Ø±Ø²ÙˆÙ…Ù‡ Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù‡ Ø¢Ø¯Ø±Ø³ Ø§ÛŒÙ…ÛŒÙ„ Ø²ÛŒØ± Ø§Ø±Ø³Ø§Ù„ ÛŒØ§ Ø¨Ø§ Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³â€Œ Ø²ÛŒØ± Ø¯Ø± Ø³Ø§Ø¹Ø§Øª Ø§Ø¯Ø§Ø±ÛŒ ØªÙ…Ø§Ø³ Ø­Ø§ØµÙ„ Ù†Ù…Ø§ÛŒÙ†Ø¯."."\r\n"."ðŸ‘‡"."\r\n".
    "â˜Žï¸ Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³: ".$message[8]."\r\n\r\n".
    "ðŸ“§ Ø¢Ø¯Ø±Ø³ Ø§ÛŒÙ…ÛŒÙ„: ".$message[9]."\r\n\r\n".
    "âž¡ï¸Ø¢Ø¯Ø±Ø³ ØªÙ„Ú¯Ø±Ø§Ù…: ".$message[10]."\r\n\r\n".
    "ðŸ“ŒØ¯Ø±ÛŒØ§ÙØª Â«ØªÙ…Ø§Ù…ÛŒ ÙØ±ØµØª Ù‡Ø§ÛŒ Ù‡Ù…Ú©Ø§Ø±ÛŒ Ø¯Ø§Ù†Ø´Ú¯Ø§Ù‡ Â»"."ðŸ‘‡ðŸ™ðŸ‘‡ðŸ™ðŸ‘‡ðŸ™".
    "@sharif_job"
  );

    file_get_contents($url);

  }//for




?>
